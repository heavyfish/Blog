<!DOCTYPE html>
<html lang="zh-Hans">
    <head>
    <meta charset="utf-8">

    

    <!-- 渲染优化 -->
    <meta name="renderer" content="webkit">
    <meta name="force-rendering" content="webkit">
    <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
    <meta name="HandheldFriendly" content="True" >
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

    <!--icon-->

    
    
    
    
    


    <!-- meta -->


<title>no title | 速查笔记</title>





    <!-- OpenGraph -->
 
    <meta name="description" content="1、keytsone12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576777879808182838485868788[DEFAULT]debug &#x3D; Falsel">
<meta property="og:type" content="article">
<meta property="og:title" content="速查笔记">
<meta property="og:url" content="https://heavyfish.github.io/2020/06/07/OpenStack/P%E7%89%88%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6/index.html">
<meta property="og:site_name" content="速查笔记">
<meta property="og:description" content="1、keytsone12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576777879808182838485868788[DEFAULT]debug &#x3D; Falsel">
<meta property="og:locale">
<meta property="article:published_time" content="2020-06-07T09:34:53.000Z">
<meta property="article:modified_time" content="2021-01-07T13:49:34.952Z">
<meta property="article:author" content="Shenxr">
<meta name="twitter:card" content="summary_large_image">


    
<link rel="stylesheet" href="/heavyfish.github.io/css/style/main.css">
 



    
    
        <link rel="stylesheet" id="hl-default-theme" href="/heavyfish.github.io/css/highlight/default.css" media="none" onload="if(getComputedStyle(document.documentElement).getPropertyValue('--color-mode').indexOf('dark')===-1)this.media='all'">
        
    

    
    

     

    <!-- custom head -->

<meta name="generator" content="Hexo 5.3.0"></head>

    <body>
        <div id="app">
            <header class="header">
    <div class="header__left">
        <a href="/heavyfish.github.io/" class="button">
            <span class="logo__text">Demo</span>
        </a>
    </div>
    <div class="header__right">
        
            <div class="navbar__menus">
                
                    <a href="/heavyfish.github.io/" class="navbar-menu button">首页</a>
                
                    <a href="/heavyfish.github.io/tags/" class="navbar-menu button">标签</a>
                
                    <a href="/heavyfish.github.io/archives/" class="navbar-menu button">归档</a>
                
                    <a href="/heavyfish.github.io/friends/" class="navbar-menu button">友链</a>
                
                    <a href="/heavyfish.github.io/page/" class="navbar-menu button">Page</a>
                
            </div>
        
        
        

        
        

        

        
            <a class="dropdown-icon button" id="btn-dropdown" tabindex="0"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" width='24' height='24' fill="none" stroke="currentColor" stroke-width="0.7" stroke-linecap="round" stroke-linejoin="round"><path fill="currentColor" d="M3.314,4.8h13.372c0.41,0,0.743-0.333,0.743-0.743c0-0.41-0.333-0.743-0.743-0.743H3.314c-0.41,0-0.743,0.333-0.743,0.743C2.571,4.467,2.904,4.8,3.314,4.8z M16.686,15.2H3.314c-0.41,0-0.743,0.333-0.743,0.743s0.333,0.743,0.743,0.743h13.372c0.41,0,0.743-0.333,0.743-0.743S17.096,15.2,16.686,15.2z M16.686,9.257H3.314c-0.41,0-0.743,0.333-0.743,0.743s0.333,0.743,0.743,0.743h13.372c0.41,0,0.743-0.333,0.743-0.743S17.096,9.257,16.686,9.257z"></path></svg></a>
            <div class="dropdown-menus" id="dropdown-menus">
                
                    <a href="/heavyfish.github.io/" class="dropdown-menu button">首页</a>
                
                    <a href="/heavyfish.github.io/tags/" class="dropdown-menu button">标签</a>
                
                    <a href="/heavyfish.github.io/archives/" class="dropdown-menu button">归档</a>
                
                    <a href="/heavyfish.github.io/friends/" class="dropdown-menu button">友链</a>
                
                    <a href="/heavyfish.github.io/page/" class="dropdown-menu button">Page</a>
                
            </div>
        
    </div>
</header>


            <main class="main">
    

<div class="post-title">
    <h1 class="post-title__text">
        no title
    </h1>
    <div class="post-title__meta">
        <a href="/heavyfish.github.io/archives/2020/06/" class="post-meta__date button">2020-06-07</a>
        
 
        
    
    


 

 
    </div>
</div>



<article class="post content-card">
    <div class="post__header"></div>
    <div class="post__content">
        <h1 id="1、keytsone"><a href="#1、keytsone" class="headerlink" title="1、keytsone"></a>1、keytsone</h1><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br></pre></td><td class="code"><pre><span class="line">[DEFAULT]</span><br><span class="line">debug = False</span><br><span class="line">log_file = /var/log/kolla/keystone/keystone.log</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> Log output to standard error. This option is ignored <span class="keyword">if</span> log_config_append is</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> <span class="built_in">set</span>. (boolean value)</span></span><br><span class="line">use_stderr = True</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[oslo_middleware]</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> Whether the application is behind a proxy or not. This determines <span class="keyword">if</span> the</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> middleware should parse the headers or not. (boolean value)</span></span><br><span class="line">enable_proxy_headers_parsing = True</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[database]</span><br><span class="line">connection = mysql+pymysql://keystone:Password@172.19.132.40:3306/keystone</span><br><span class="line"><span class="meta">#</span><span class="bash"> Set to -1 to specify an infinite retry count</span></span><br><span class="line">max_retries = -1</span><br><span class="line"><span class="meta">#</span><span class="bash"> Maximum number of SQL connections to keep open <span class="keyword">in</span> a pool</span></span><br><span class="line">max_pool_size = 10</span><br><span class="line">max_overflow = 20</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 闲置连接的超时时间</span></span><br><span class="line">idle_timeout = 60</span><br><span class="line"></span><br><span class="line">[token]</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> toggle 撤消单个令牌的支持，通过token identifier 和 对各种令牌枚举操作（例如列出发行给特定用户的所有令牌）</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 这些操作用于确定要撤消的令牌列表。 如果您使用的是`kvs`` [revoke]驱动程序，请不要禁用此选项。</span></span><br><span class="line">revoke_by_id = False</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> Entry point <span class="keyword">for</span> the token provider <span class="keyword">in</span> the `keystone.token.provider`</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> namespace. The token provider controls the token construction, validation,</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> and revocation operations. Keystone includes `fernet` and `uuid` token</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> providers. `uuid` tokens must be persisted (using the backend specified <span class="keyword">in</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> the `[token] driver` option), but <span class="keyword">do</span> not require any extra configuration or</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> setup. `fernet` tokens <span class="keyword">do</span> not need to be persisted at all, but require that</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> you run `keystone-manage fernet_setup` (also see the `keystone-manage</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> fernet_rotate` <span class="built_in">command</span>). (string value)</span></span><br><span class="line">provider = uuid</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 令牌应保持有效的时间（以秒为单位）。</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 大幅降低该值可能会破坏涉及多个服务以进行协调的“长时间运行”操作，并且将迫使用户更频繁地通过keystone校正进行身份验证。</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 急剧增加此值将增加[token]驱动程序的负载，因为更多的令牌将同时有效。</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> Keystone令牌也是Bearer token，因此较短的持续时间也将减少泄露的令牌对安全的潜在影响。</span></span><br><span class="line">expiration = 21600</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[cache]</span><br><span class="line"><span class="meta">#</span><span class="bash"> Dogpile.cache后端模块。建议使用Memcache或Redis</span></span><br><span class="line"><span class="meta">#</span><span class="bash">（dogpile.cache.redis）用于生产部署。对于基于事件的</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 或高度线程化的服务器，建议使用 Memcache with pooling （oslo_cache.memcache_pool）</span></span><br><span class="line">backend = oslo_cache.memcache_pool</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> Global toggle <span class="keyword">for</span> caching</span></span><br><span class="line">enabled = True</span><br><span class="line">memcache_servers = 172.19.132.2:11211,172.19.132.3:11211,172.19.132.4:11211</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> dogpile.cache区域中任何缓存的项目的默认TTL（以秒为单位）。</span></span><br><span class="line">expiration_time = 10800</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> memcache被认为dead后，等待再次尝试的时间</span></span><br><span class="line">memcache_dead_retry = 3600</span><br><span class="line"><span class="meta">#</span><span class="bash"> 每次调用服务的超时时间（以秒为单位）</span></span><br><span class="line">memcache_socket_timeout = 1</span><br><span class="line"><span class="meta">#</span><span class="bash"> 与每个Memcached服务器的最大打开连接总数。</span></span><br><span class="line">memcache_pool_maxsize = 100</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[cors]</span><br><span class="line"><span class="meta">#</span><span class="bash"> 此资源可被跨域访问</span></span><br><span class="line">allowed_origin = http://172.19.132.40:3000</span><br><span class="line"></span><br><span class="line">[memcache]</span><br><span class="line"><span class="meta">#</span><span class="bash"> memcached 服务被认为dead后，再次尝试访问的时间</span></span><br><span class="line">dead_retry = 3600</span><br><span class="line"><span class="meta">#</span><span class="bash"> 每次调用服务的超时时间（以秒为单位）.键值存储系统使用它。（整数值）</span></span><br><span class="line">socket_timeout = 1</span><br><span class="line"></span><br><span class="line">[keystone_authtoken]</span><br><span class="line"><span class="meta">#</span><span class="bash"> memcache被认为dead后，等待再次尝试的时间</span></span><br><span class="line">memcache_pool_dead_retry = 3600</span><br><span class="line"><span class="meta">#</span><span class="bash"> 每次调用服务的超时时间（以秒为单位）</span></span><br><span class="line">memcache_pool_socket_timeout = 1</span><br></pre></td></tr></table></figure>






<p>‌</p>
<h1 id="2、glance"><a href="#2、glance" class="headerlink" title="2、glance"></a>2、glance</h1><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br></pre></td><td class="code"><pre><span class="line">[DEFAULT]</span><br><span class="line">debug = False</span><br><span class="line">log_file = /var/log/kolla/glance/glance-api.log</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 绑定到glance 服务的地址</span></span><br><span class="line">bind_host = 172.19.132.2</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> glance 服务监听的端口</span></span><br><span class="line">bind_port = 9292</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> glance服务启动时的线程数</span></span><br><span class="line">workers = 5</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 仓库主机地址</span></span><br><span class="line">registry_host = 172.19.132.40</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> glance show image时，显示images的真实存储位置</span></span><br><span class="line">show_image_direct_url = True</span><br><span class="line"><span class="meta">#</span><span class="bash"> glance show image时，返回images的所有存储位置，Pike及之后被移除</span></span><br><span class="line">show_multiple_locations = True</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 当从service catalog中寻找cinder时，要匹配的信息</span></span><br><span class="line">cinder_catalog_info = volume:cinder:internalURL</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> ＃表示要使用的消息传递驱动程序及其完整配置的URL</span></span><br><span class="line">transport_url = rabbit://openstack:Password@172.19.132.2:5672</span><br><span class="line"><span class="meta">#</span><span class="bash"> 用于连接数据库的SQLAlchemy连接字符串</span></span><br><span class="line">connection = mysql+pymysql://glance:Password@172.19.132.40:3306/glance</span><br><span class="line">max_retries = -1</span><br><span class="line">max_pool_size = 10</span><br><span class="line">max_overflow = 20</span><br><span class="line">idle_timeout = 60</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[keystone_authtoken]</span><br><span class="line"><span class="meta">#</span><span class="bash"> 完整的“public”身份API端点。S版本被移除，后续使用www_authenticate_uri=</span></span><br><span class="line">auth_uri = http://172.19.132.40:5000</span><br><span class="line"><span class="meta">#</span><span class="bash"> 完整的“admin”身份API端点</span></span><br><span class="line">auth_url = http://172.19.132.40:35357</span><br><span class="line">auth_type = password</span><br><span class="line">project_domain_id = default</span><br><span class="line">user_domain_id = default</span><br><span class="line">project_name = service</span><br><span class="line">username = glance</span><br><span class="line">password = 5bgBFrigaZryHEa53RADpPBorCAMW39qXkWcbqDL</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> token数据被加密后在cache中进行身份验证</span></span><br><span class="line">memcache_security_strategy = ENCRYPT</span><br><span class="line"><span class="meta">#</span><span class="bash"> 此字符串用于密钥派生</span></span><br><span class="line">memcache_secret_key = 4FlGmUgmcUrzB1KrJnye7V86iAtQq1quvp7jgJqN</span><br><span class="line">memcached_servers = 172.19.132.2:11211,172.19.132.3:11211,172.19.132.4:11211</span><br><span class="line">memcache_pool_dead_retry = 3600</span><br><span class="line">memcache_pool_socket_timeout = 1</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[paste_deploy]</span><br><span class="line"><span class="meta">#</span><span class="bash"> Deployment flavor to use <span class="keyword">in</span> the server application pipeline</span></span><br><span class="line">flavor = keystone</span><br><span class="line"></span><br><span class="line">[glance_store]</span><br><span class="line">default_store = rbd</span><br><span class="line">stores = file,http,rbd,cinder</span><br><span class="line">rbd_store_user = glance</span><br><span class="line">rbd_store_pool = images</span><br><span class="line"><span class="meta">#</span><span class="bash"> image会分块为此大小的对象（单位：M）,值应该为2的幂次方</span></span><br><span class="line">rbd_store_chunk_size = 8</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[oslo_middleware]</span><br><span class="line">enable_proxy_headers_parsing = True</span><br><span class="line"></span><br><span class="line">[oslo_messaging_notifications]</span><br><span class="line"><span class="meta">#</span><span class="bash"> 用于处理发送 notifications 的driver。</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 可能的值messaging，messagingv2, routing, <span class="built_in">log</span>, <span class="built_in">test</span>, noop (multi valued)</span></span><br><span class="line">driver = messagingv2</span><br></pre></td></tr></table></figure>
<p>‌</p>
<h1 id="3、nova"><a href="#3、nova" class="headerlink" title="3、nova"></a>3、nova</h1><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br></pre></td><td class="code"><pre><span class="line">[DEFAULT]</span><br><span class="line">debug = False</span><br><span class="line">log_dir = /var/log/kolla/nova</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 此目录用于存储Nova的内部状态。 从中派生的各种其他配置选项都使用它。</span> </span><br><span class="line"><span class="meta">#</span><span class="bash"> 在某些情况下（例如，迁移），使用在多个计算主机之间共享的存储位置（例如，通过NFS）是有意义的。</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 除非选项``instances_path``被覆盖，否则该目录可能会变得很大。</span></span><br><span class="line">state_path = /var/lib/nova</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> The OpenStack API service 监听的IP</span></span><br><span class="line">osapi_compute_listen = 172.19.132.2</span><br><span class="line"><span class="meta">#</span><span class="bash"> The OpenStack API service 监听的端口</span></span><br><span class="line">osapi_compute_listen_port = 8774</span><br><span class="line"><span class="meta">#</span><span class="bash"> OpenStack API service 进程数. 默认为可用的CPU数量</span></span><br><span class="line">osapi_compute_workers = 5</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> metadat API 相关的</span></span><br><span class="line">metadata_workers = 5</span><br><span class="line">metadata_listen = 172.19.132.2</span><br><span class="line">metadata_listen_port = 8775</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">allow_resize_to_same_host = true</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 定义用于控制虚拟化的驱动程序。</span></span><br><span class="line">compute_driver = libvirt.LibvirtDriver</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 主机用于连接管理网络的IP地址</span></span><br><span class="line">my_ip = 172.19.132.2</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 此选项启用定期的compute.instance.exists通知。</span> </span><br><span class="line"><span class="meta">#</span><span class="bash"> 必须将每个计算节点配置为生成系统使用情况数据。</span> </span><br><span class="line"><span class="meta">#</span><span class="bash"> 这些通知由OpenStack Telemetry服务使用。</span></span><br><span class="line">instance_usage_audit = True</span><br><span class="line">instance_usage_audit_period = hour</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">transport_url = rabbit://openstack:Pass@172.19.132.2:5672</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 在 config drive 强制注入</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 当此选项设置为<span class="literal">true</span>时，默认情况下将强制启用config drive，</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 否则用户仍可以通过REST API 或 image元数据属性启用配置驱动器。</span></span><br><span class="line">force_config_drive = true</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 自上次报告up以来，可容忍无报告的最大时长</span></span><br><span class="line">service_down_time = 120</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 是否删除未使用的base image</span></span><br><span class="line">remove_unused_base_images = False</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 两次image cache manager之间等待的秒数。</span></span><br><span class="line">image_cache_manager_interval = 0</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 此选项指定是否启动物理节点重启前之前正在运行的客户机。</span> </span><br><span class="line"><span class="meta">#</span><span class="bash"> 它确保每次计算节点启动或重新启动时，Nova计算节点上的所有实例都恢复其状态。</span></span><br><span class="line">resume_guests_state_on_host_boot = True</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> Seconds to <span class="built_in">wait</span> <span class="keyword">for</span> a response from a call. (<span class="built_in">integer</span> value)</span></span><br><span class="line">rpc_response_timeout = 300</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 等待Neutron VIF插入事件消息到达前的超时秒数</span></span><br><span class="line">vif_plugging_timeout = 10</span><br><span class="line"><span class="meta">#</span><span class="bash"> Determine <span class="keyword">if</span> instance should boot or fail on VIF plugging timeout.</span></span><br><span class="line">vif_plugging_is_fatal = False</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 不推荐使用了，最好在[vnc]中加入enabled = <span class="literal">true</span></span></span><br><span class="line">vnc_enabled = true</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[api]</span><br><span class="line"><span class="meta">#</span><span class="bash"> 设为True时，“X-Forwarded-For” header 被视为规范的远程地址。设为False（默认设置）时，将使用“ remote_address” header。</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 仅当具有 HTML sanitizing proxy 时，才应启用此功能</span></span><br><span class="line">use_forwarded_for = true</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[conductor]</span><br><span class="line">workers = 5</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[vnc]</span><br><span class="line"><span class="meta">#</span><span class="bash"> noVNC控制台代理应绑定的IP地址。</span></span><br><span class="line">novncproxy_host = 172.19.132.2</span><br><span class="line">novncproxy_port = 6080</span><br><span class="line">vncserver_listen = 172.19.132.2</span><br><span class="line"><span class="meta">#</span><span class="bash"> VNC控制台代理的私有，内部IP地址或主机名</span></span><br><span class="line">vncserver_proxyclient_address = 172.19.132.2</span><br><span class="line"><span class="meta">#</span><span class="bash"> Public address of noVNC VNC console proxy.</span></span><br><span class="line">novncproxy_base_url = http://172.19.132.40:6080/vnc_auto.html</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[oslo_middleware]</span><br><span class="line">enable_proxy_headers_parsing = True</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[oslo_concurrency]</span><br><span class="line"><span class="meta">#</span><span class="bash"> 用于锁文件的目录。</span> </span><br><span class="line"><span class="meta">#</span><span class="bash"> 为了安全起见，指定目录只能由 运行 需要锁的进程 的用户写入。</span> </span><br><span class="line"><span class="meta">#</span><span class="bash"> 默认为环境变量OSLO_LOCK_PATH。 如果使用外部锁，则必须设置一个锁路径</span></span><br><span class="line">lock_path = /var/lib/nova/tmp</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[glance]</span><br><span class="line"><span class="meta">#</span><span class="bash"> 可用于nova的glance api服务器端点列表</span></span><br><span class="line">api_servers = http://172.19.132.40:9292</span><br><span class="line"><span class="meta">#</span><span class="bash"> uploading / downloading image的尝试次数，0表示不重试</span></span><br><span class="line">num_retries = 3</span><br><span class="line">debug = False</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[cinder]</span><br><span class="line"><span class="meta">#</span><span class="bash"> 在服务目录中查找cinder时要匹配的信息</span></span><br><span class="line">catalog_info = volumev3:cinderv3:internalURL</span><br><span class="line">os_region_name = RegionOne</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[neutron]</span><br><span class="line"><span class="meta">#</span><span class="bash"> 此选项指定用于连接Neutron的URL</span></span><br><span class="line">url = http://172.19.132.40:9696</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 此选项包含用于验证到neutron metadata的代理请求</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 为了被使用，<span class="string">&#x27;X-Metadata-Provider-Signature&#x27;</span>标头必须在请求中提供</span></span><br><span class="line">metadata_proxy_shared_secret = AlBIz8otjoshFQQ51oA2xeOLKMIbbYi6NqO7qZdu</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 设置为True时，此选项表示Neutron将使用proxy metadata请求并解析实例ID。</span> </span><br><span class="line"><span class="meta">#</span><span class="bash"> 否则，必须在“ X-Instance-ID”标头中将实例ID传递到元数据请求。</span></span><br><span class="line">service_metadata_proxy = true</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> Authentication URL</span></span><br><span class="line">auth_url = http://172.19.132.40:35357</span><br><span class="line">auth_type = password</span><br><span class="line">project_domain_name = Default</span><br><span class="line">user_domain_id = default</span><br><span class="line">project_name = service</span><br><span class="line">username = neutron</span><br><span class="line">password = YFONWGgttKAsLSWo1GffIrTZtDVeF483wOsBVKox</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[database]</span><br><span class="line">connection = mysql+pymysql://nova:j5vuakfweENL2sTXYDdV6PIn0dVFJeLWaDialKQ8@172.19.132.40:3306/nova</span><br><span class="line">max_pool_size = 10</span><br><span class="line">max_overflow = 20</span><br><span class="line">max_retries = -1</span><br><span class="line">idle_timeout = 60</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[api_database]</span><br><span class="line"><span class="meta">#</span><span class="bash"> Nova API数据库是一个单独的数据库，用于跨cells使用的信息</span></span><br><span class="line">connection = mysql+pymysql://nova_api:NxF8kr3ydSntTU2UGzzxgB94Rc5XNhobz0228Dxg@172.19.132.40:3306/nova_api</span><br><span class="line">max_retries = -1</span><br><span class="line">max_overflow = 10</span><br><span class="line">max_pool_size = 120</span><br><span class="line">pool_timeout = 30</span><br><span class="line">idle_timeout = 60</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[cache]</span><br><span class="line">backend = oslo_cache.memcache_pool</span><br><span class="line">enabled = True</span><br><span class="line">memcache_servers = 172.19.132.2:11211,172.19.132.3:11211,172.19.132.4:11211</span><br><span class="line">expiration_time = 10800</span><br><span class="line">memcache_dead_retry = 3600</span><br><span class="line">memcache_socket_timeout = 1</span><br><span class="line">memcache_pool_maxsize = 100</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[keystone_authtoken]</span><br><span class="line">auth_uri = http://172.19.132.40:5000</span><br><span class="line">auth_url = http://172.19.132.40:35357</span><br><span class="line">auth_type = password</span><br><span class="line">project_domain_id = default</span><br><span class="line">user_domain_id = default</span><br><span class="line">project_name = service</span><br><span class="line">username = nova</span><br><span class="line">password = kH4EhHDUFV5P7UBVnZskUzRArcoSSa4vF8PYd4zP</span><br><span class="line">memcache_security_strategy = ENCRYPT</span><br><span class="line">memcache_secret_key = 4FlGmUgmcUrzB1KrJnye7V86iAtQq1quvp7jgJqN</span><br><span class="line">memcached_servers = 172.19.132.2:11211,172.19.132.3:11211,172.19.132.4:11211</span><br><span class="line">memcache_pool_dead_retry = 3600</span><br><span class="line">memcache_pool_socket_timeout = 1</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[libvirt]</span><br><span class="line"><span class="meta">#</span><span class="bash"> 配置了libvirt hypervisor相关的选项</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 几乎所有的libvirt配置选项都受``virt_type``配置的影响</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 覆盖所选虚拟化类型的默认libvirt URI。</span></span><br><span class="line">connection_uri = qemu+tcp://172.19.132.2/system</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> VM Images format</span></span><br><span class="line">images_type = rbd</span><br><span class="line">images_rbd_pool = vms</span><br><span class="line">images_rbd_ceph_conf = /etc/ceph/ceph.conf</span><br><span class="line">rbd_user = nova</span><br><span class="line">rbd_secret_uuid = 5d4fbaf7-6eef-4ae9-908b-f7476cca0dd8</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 为不同的 disk types 指定不同的 cache 模式</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> For example: file=directsync,block=none,network=writeback</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 对于本地或直接连接存储，建议使用 writethrough（直写） (default) 模式，因为它可以确保数据完整性，并且对于guest中运行的应用程序（尤其是读取操作）具有可接受的I / O性能。 但是，建议将缓存模式 none 用于远程NFS存储，因为直接I/O操作（O_DIRECT）的性能要优于同步I/O操作（使用O_SYNC）。 缓存模式 none 有效地将所有guest I/O操作转换为主机（在此环境中为NFS客户端）上的直接I/O操作。</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> * default: Same as writethrough（直写模式）</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> * none:将缓存模式设置为none时，将禁用host page cache，但是将为guest 启用disk write cache。这种模式下，guest中的写入性能最佳，因为写入操作会绕过主机页面缓存，并直接进入磁盘写缓存。 如果磁盘写高速缓存由电池供电，或者guest中的应用程序或存储堆栈正确地传输了数据（通过fsync操作或文件系统屏障），则可以确保数据完整性。 但是，由于禁用了主机页面缓存，因此guest中的读取性能将不如启用主机页面缓存的模式（如直写模式）那样好</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> * writethrough:直写模式是默认的缓存模式。 将缓存设置为直写模式时，将启用主机页缓存，但对guest禁用磁盘写缓存。 因此，即使guest中的应用程序和存储堆栈未正确地（通过fsync操作或文件系统屏障）将数据传输到永久存储，该缓存模式也可以确保数据完整性。 由于以这种模式启用了主机页面缓存，因此，guest中运行的应用程序的读取性能通常会更好。 但是，由于磁盘写缓存被禁用，因此写性能可能会降低。</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> * writeback: 将缓存设置为回写模式时，将为guest启用主机页缓存和磁盘写缓存。 因此，guest中运行的应用程序的I/O性能良好，但是在断电时不会保护数据。 因此，仅对于不考虑潜在数据丢失的临时数据，建议使用此缓存模式。</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> * directsync: Like <span class="string">&quot;writethrough&quot;</span>, but it bypasses the host page cache.</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> * unsafe:unsafe的缓存模式将完全忽略缓存传输操作。 顾名思义，此缓存模式仅应用于不考虑数据丢失的临时数据。 该模式对于加快guest安装速度很有用，但是您应该在生产环境中切换到另一种缓存模式。</span></span><br><span class="line">disk_cachemodes = network=writeback</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> Discard option <span class="keyword">for</span> nova managed disks</span></span><br><span class="line">hw_disk_discard = unmap</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> libvirt应该采用的虚拟化类型</span></span><br><span class="line">virt_type = kvm</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 确定如何选择文件系统向其中注入数据。</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> *libguestfs*将被用作注入数据的首选方案。 如果其在主机上不可用，image将被本地挂载在主机上作为备用解决方案。 如果libguestfs无法确定根分区（因为存在一个或多个根分区）或无法挂载文件系统，则将导致错误，并且实例将无法启动。</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> Possible values:</span></span><br><span class="line"><span class="meta">#</span></span><br><span class="line"><span class="bash"><span class="comment"># * -2 =&gt; disable the injection of data.</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> * -1 =&gt; find the root partition with the file system to mount with libguestfs</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> *  0 =&gt; The image is not partitioned</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> * &gt;0 =&gt; The number of the partition to use <span class="keyword">for</span> the injection</span></span><br><span class="line">inject_partition = -1</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 仅允许在``create<span class="string">&#x27;&#x27;</span>和``rebuild<span class="string">&#x27;&#x27;</span>过程中注入管理员密码。</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> image中不需要代理即可执行此操作。 如果主机上有* libguestfs *，将使用它。 否则，将使用* nbd *。 文件系统的image将被挂载，并将REST API调用中提供的管理员密码作为root用户的密码注入。 如果没有root用户可用，则实例将不会启动，并且会引发错误。</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 请注意，从卷启动实例时，*不可能*进行注入。</span></span><br><span class="line">inject_password = True</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 用于设置实例应具有的CPU模式。</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> If virt_type=<span class="string">&quot;kvm|qemu&quot;</span>, it will default to <span class="string">&quot;host-model&quot;</span>, otherwise it will default to <span class="string">&quot;none&quot;</span>.</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> Possible values:</span></span><br><span class="line"><span class="meta">#</span></span><br><span class="line"><span class="bash"><span class="comment"># * ``host-model``: Clones the host CPU feature flags.</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> * ``host-passthrough``: Use the host CPU model exactly;</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> * ``custom``: Use a named CPU model;</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> * ``none``: Not <span class="built_in">set</span> any CPU model.</span></span><br><span class="line">cpu_mode = host-model</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[upgrade_levels]</span><br><span class="line"><span class="meta">#</span><span class="bash"> upgrade_levels选项用于为在不同nova服务之间发送的RPC消息设置版本上限。</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 默认情况下，所有服务使用最新版本发送消息</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 当进行滚动升级，新旧服务并存时，此选项会很有用</span></span><br><span class="line">compute = auto</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[oslo_messaging_notifications]</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> The Drivers(s) to handle sending notifications.</span></span><br><span class="line">driver = messagingv2</span><br><span class="line"><span class="meta">#</span><span class="bash"> AMQP topic used <span class="keyword">for</span> OpenStack notifications. (list value)</span></span><br><span class="line">topics = notifications</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[guestfs]</span><br><span class="line"><span class="meta">#</span><span class="bash"> libguestfs是用于访问和修改虚拟机（VM）磁盘映像的一组工具。 您可以使用它来查看和编辑guest系统中的文件，编写对VM的更改脚本，监视磁盘已用/可用统计信息，创建guest系统，P2V，V2V，执行备份，克隆VM，构建VM，格式化磁盘和调整磁盘大小。</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> Enable/disables guestfs logging.</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> In order to use the above feature,<span class="string">&quot;libguestfs&quot;</span> package must be installed.</span></span><br><span class="line">debug = False</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[wsgi]</span><br><span class="line"><span class="meta">#</span><span class="bash"> Options under this group are used to configure WSGI (Web Server Gateway</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> Interface). WSGI is used to serve API requests.</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 此选项代表nova-api的paste.deploy配置的文件名.</span></span><br><span class="line">api_paste_config = /etc/nova/api-paste.ini</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[scheduler]</span><br><span class="line"><span class="meta">#</span><span class="bash"> 尝试选择主机的调度最大次数.</span></span><br><span class="line">max_attempts = 5</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">此值控制scheduler尝试发现已添加到cells的新主机（hypervisor）的频率（以秒为单位）。 如果为负（默认值），则不会发生自动发现。</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 计算节点频繁出入的部署可能需要启用此功能，其他情况可能希望在添加主机时手动发现主机，以避免不断检查带来的开销。 如果启用，每到该运行时，我们运行，以将从每个单元数据库中找到任何未映射的主机。</span></span><br><span class="line">discover_hosts_in_cells_interval = 60</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[placement]</span><br><span class="line">auth_type = password</span><br><span class="line">auth_url = http://172.19.132.40:35357</span><br><span class="line">username = placement</span><br><span class="line">password = arZhoy83cccmjbtPaIcBiJ3ZILgQT6Reabzk17yN</span><br><span class="line">user_domain_name = Default</span><br><span class="line">project_name = service</span><br><span class="line">project_domain_name = Default</span><br><span class="line">os_region_name = RegionOne</span><br><span class="line">os_interface = internal</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[notifications]</span><br><span class="line"><span class="meta">#</span><span class="bash"> Nova中大多数操作系统状态的操作都会生成通知，这些通知将发布到消息传递组件（例如RabbitMQ），并且可由Openstack外部的任何服务使用。 有关更多技术细节，请访问http://docs.openstack.org/developer/nova/notifications.html</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> If <span class="built_in">set</span>, send compute.instance.update notifications on instance state changes.</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> Possible values:</span></span><br><span class="line"><span class="meta">#</span></span><br><span class="line"><span class="bash"><span class="comment"># * None - no notifications</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> * vm_state”-通知在“ old_state”和“ state”字段中随VM状态转换信息一起发送。 ``old_task_state``和``new_task_state``字段将设置为实例的当前task_state。</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> * <span class="string">&quot;vm_and_task_state&quot;</span> - 通知与VM任务状态转换信息一起发送。</span></span><br><span class="line">notify_on_state_change = vm_and_task_state</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 指定nova使用哪种通知格式。</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> unversioned：仅发出传统未版本化的通知。</span></span><br><span class="line">notification_format = unversioned</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[memcache]</span><br><span class="line">dead_retry = 3600</span><br><span class="line">socket_timeout = 1</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[serial_console]</span><br><span class="line"><span class="meta">#</span><span class="bash"> 如果没有VNC，RDP或SPICE之类的图形控制台，则可以使用串行控制台功能连接到guest。 目前仅libvirt，Ironic和hyper-v驱动程序支持此功能。</span></span><br><span class="line">enabled = false</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[filter_scheduler]</span><br><span class="line"><span class="meta">#</span><span class="bash"> 调度程序选择的最佳主机的子集大小。</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 将在从N个最佳主机的子集中随机选择的主机上调度新实例，其中N是此选项设置的值。</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 将其设置为大于1的值将减少多个处理类似请求的调度程序进程选择同一主机的可能性，从而创建潜在的竞争条件。 通过从最适合该请求的N个主机中随机选择一个主机，可以减少发生冲突的机会。 但是，设置的值越高，对于给定的请求，所选主机的最佳性就越差。</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 此选项仅由FilterScheduler及其子类使用； 如果使用其他调度程序，则此选项无效。</span></span><br><span class="line">host_subset_size = 10</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 可以在主机上主动执行IO的实例数。</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 执行IO的实例包括以下状态的实例：build, resize, snapshot, migrate, rescue, unshelve</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 此选项仅由FilterScheduler及其子类使用； 如果使用其他调度程序，则此选项无效。 另请注意，如果启用了“ io_ops_filter”过滤器，则此设置仅影响调度。</span></span><br><span class="line">max_io_ops_per_host = 10</span><br><span class="line"></span><br><span class="line">enabled_filters = RetryFilter,AvailabilityZoneFilter,ComputeFilter,ComputeCapabilitiesFilter,ImagePropertiesFilter,ServerGroupAntiAffinityFilter,ServerGroupAffinityFilter,AggregateCoreFilter,AggregateDiskFilter,DifferentHostFilter,SameHostFilter</span><br></pre></td></tr></table></figure>
<p>补充</p>
<p><a target="_blank" rel="noopener" href="https://www.jianshu.com/p/c154f43b7fac">Libguestfs介绍</a></p>
<h1 id="4、cinder"><a href="#4、cinder" class="headerlink" title="4、cinder"></a>4、cinder</h1><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br></pre></td><td class="code"><pre><span class="line">[DEFAULT]</span><br><span class="line">debug = False</span><br><span class="line">log_dir = /var/log/kolla/cinder</span><br><span class="line">use_forwarded_for = true</span><br><span class="line">use_stderr = False</span><br><span class="line">my_ip = 172.19.132.2</span><br><span class="line">osapi_volume_workers = 5</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 用于生成volume名字的模板字符串</span></span><br><span class="line">volume_name_template = volume-%s</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 可用于cinder的glance API服务器的URL列表</span></span><br><span class="line">glance_api_servers = http://172.19.132.40:9292</span><br><span class="line"><span class="meta">#</span><span class="bash"> Number retries when downloading an image from glance (<span class="built_in">integer</span> value)</span></span><br><span class="line">glance_num_retries = 3</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 要使用的后端名称列表。这些后端名称应由唯一的[CONFIG]组及其选项（列表值）支持</span></span><br><span class="line">enabled_backends = rbd-1,rbd-2</span><br><span class="line"></span><br><span class="line">osapi_volume_listen = 172.19.132.2</span><br><span class="line">osapi_volume_listen_port = 8776</span><br><span class="line">api_paste_config = /etc/cinder/api-paste.ini</span><br><span class="line">auth_strategy = keystone</span><br><span class="line">transport_url = rabbit://openstack:Pass@172.19.132.2:5672</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 启用此后端的image volume cache</span></span><br><span class="line">image_volume_cache_enabled = True</span><br><span class="line"><span class="meta">#</span><span class="bash"> image volume cache在后端中的最大大小. 0 =&gt; unlimited.</span></span><br><span class="line">image_volume_cache_max_size_gb = 500</span><br><span class="line"><span class="meta">#</span><span class="bash"> image volume cache中允许的最大条目数. 0 =&gt; unlimited.</span></span><br><span class="line">image_volume_cache_max_count = 50</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 如果请求的Cinder可用域不可用，请退回到default_availability_zone的值，然后再降为storage_availability_zone的值，而不是失败。</span></span><br><span class="line">allow_availability_zone_fallback = True</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 在upload_to_image上启用“Force”选项。 这样可以在in-use的volume上为支持它的后端运行upload_volume</span></span><br><span class="line">enable_force_upload = True</span><br><span class="line"></span><br><span class="line">[oslo_messaging_notifications]</span><br><span class="line">driver = messagingv2</span><br><span class="line">topics = notifications</span><br><span class="line"></span><br><span class="line">[oslo_middleware]</span><br><span class="line">enable_proxy_headers_parsing = True</span><br><span class="line"></span><br><span class="line">[nova]</span><br><span class="line">region_name = RegionOne</span><br><span class="line"><span class="meta">#</span><span class="bash"> 要使用的nova端点的类型。该端点将在keystone catalog中查找，并且应该是public，internal或admin之一</span></span><br><span class="line">interface = internal</span><br><span class="line"><span class="meta">#</span><span class="bash"> 使用当前用户时用于nova连接的身份验证URL</span></span><br><span class="line">token_auth_url = http://172.19.132.40:5000</span><br><span class="line"></span><br><span class="line">[database]</span><br><span class="line"><span class="meta">#</span><span class="bash"> The SQLAlchemy connection string to use to connect to the database</span></span><br><span class="line">connection = mysql+pymysql://cinder:Pass@172.19.132.40:3306/cinder</span><br><span class="line">max_retries = -1</span><br><span class="line">max_pool_size = 10</span><br><span class="line">max_overflow = 20</span><br><span class="line">idle_timeout = 60</span><br><span class="line"></span><br><span class="line">[keystone_authtoken]</span><br><span class="line">auth_uri = http://172.19.132.40:5000</span><br><span class="line">auth_url = http://172.19.132.40:35357</span><br><span class="line">auth_type = password</span><br><span class="line">project_domain_id = default</span><br><span class="line">user_domain_id = default</span><br><span class="line">project_name = service</span><br><span class="line">username = cinder</span><br><span class="line">password = Password</span><br><span class="line">memcache_security_strategy = ENCRYPT</span><br><span class="line">memcache_secret_key = 4FlGmUgmcUrzB1KrJnye7V86iAtQq1quvp7jgJqN</span><br><span class="line">memcached_servers = 172.19.132.2:11211,172.19.132.3:11211,172.19.132.4:11211</span><br><span class="line">memcache_pool_dead_retry = 3600</span><br><span class="line">memcache_pool_socket_timeout = 1</span><br><span class="line"></span><br><span class="line">[oslo_concurrency]</span><br><span class="line">lock_path = /var/lib/cinder/tmp</span><br><span class="line"></span><br><span class="line">[rbd-1]</span><br><span class="line"><span class="meta">#</span><span class="bash"> 用于创建卷的驱动程序</span></span><br><span class="line">volume_driver = cinder.volume.drivers.rbd.RBDDriver</span><br><span class="line"><span class="meta">#</span><span class="bash"> 对给定的driver驱动进行 自命名</span></span><br><span class="line">volume_backend_name = rbd-1</span><br><span class="line"></span><br><span class="line">rbd_pool = volumes</span><br><span class="line">rbd_ceph_conf = /etc/ceph/ceph.conf</span><br><span class="line">rbd_user = cinder</span><br><span class="line">rbd_secret_uuid = de6201a3-a49d-4282-90f1-865e9064fd4a</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 展平从快照创建的卷以消除卷与快照之间的依赖关系</span></span><br><span class="line">rbd_flatten_volume_from_snapshot = false</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 在展平前的最大嵌套克隆克隆数量。设为0则禁止克隆。</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 例如，01复制成02，02复制成03，...，到06复制成07时（第6次嵌套复制了，&gt;5），会触发flatten操作，然后，06将不再有parent</span></span><br><span class="line">rbd_max_clone_depth = 5</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 卷将被分块到此大小的对象中</span></span><br><span class="line">rbd_store_chunk_size = 4</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 连接到ceph cluster的超时时间</span></span><br><span class="line">rados_connect_timeout = 5</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 向Cinder的客户端报告后端支持丢弃（aka.trim / unmap）。 这实际上并不会直接更改后端或客户端的行为，它只会通知它可以使用</span></span><br><span class="line">report_discard_supported = True</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 如果设置为True，则以raw格式上传image时 将创建一个克隆的卷并将其位置注册到glance，而不是上传volume的内容。 在glance中必须启用 cinder backend 和 locations support</span></span><br><span class="line">image_upload_use_cinder_backend = False</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[cache]</span><br><span class="line">expiration_time = 10800</span><br><span class="line">memcache_dead_retry = 3600</span><br><span class="line">memcache_socket_timeout = 1</span><br><span class="line">memcache_pool_maxsize = 100</span><br><span class="line"></span><br><span class="line">[memcache]</span><br><span class="line">dead_retry = 3600</span><br><span class="line">socket_timeout = 1</span><br><span class="line"></span><br><span class="line">[rbd-2]</span><br><span class="line">volume_driver = cinder.volume.drivers.rbd.RBDDriver</span><br><span class="line">volume_backend_name = rbd-2</span><br><span class="line">rbd_pool = ssd</span><br><span class="line">rbd_ceph_conf = /etc/ceph/ceph.conf</span><br><span class="line">rbd_flatten_volume_from_snapshot = false</span><br><span class="line">rbd_max_clone_depth = 5</span><br><span class="line">rbd_store_chunk_size = 4</span><br><span class="line">rados_connect_timeout = 5</span><br><span class="line">rbd_user = cinder</span><br><span class="line">rbd_secret_uuid = de6201a3-a49d-4282-90f1-865e9064fd4a</span><br><span class="line">report_discard_supported = True</span><br><span class="line">image_upload_use_cinder_backend = False</span><br></pre></td></tr></table></figure>
<p><a target="_blank" rel="noopener" href="https://docs.openstack.org/cinder/rocky/configuration/block-storage/samples/cinder.conf.html">cinder conf</a></p>
<h1 id="5、neutron"><a href="#5、neutron" class="headerlink" title="5、neutron"></a>5、neutron</h1><p><a target="_blank" rel="noopener" href="https://docs.openstack.org/neutron/pike/configuration/index.html#sample-configuration-files">nuetron conf</a></p>
<h2 id="5-1、neutron-conf"><a href="#5-1、neutron-conf" class="headerlink" title="5.1、neutron.conf"></a>5.1、neutron.conf</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br></pre></td><td class="code"><pre><span class="line">[DEFAULT]</span><br><span class="line">debug = False</span><br><span class="line">log_dir = /var/log/kolla/neutron</span><br><span class="line">use_stderr = False</span><br><span class="line">bind_host = 172.19.132.2</span><br><span class="line">bind_port = 9696</span><br><span class="line">api_paste_config = /usr/share/neutron/api-paste.ini</span><br><span class="line">endpoint_type = internal</span><br><span class="line">api_workers = 5</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> Number of RPC worker processes <span class="keyword">for</span> service. (<span class="built_in">integer</span> value)</span></span><br><span class="line">rpc_workers = 3</span><br><span class="line"><span class="meta">#</span><span class="bash"> 专用于状态报告队列的RPC进程数</span></span><br><span class="line">rpc_state_report_workers = 3</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> Location <span class="keyword">for</span> Metadata Proxy UNIX domain socket. (string value)</span></span><br><span class="line">metadata_proxy_socket = /var/lib/neutron/kolla/metadata_proxy</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 管理virtual interface的driver</span></span><br><span class="line">interface_driver = openvswitch</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 在Neutron中允许overlapping IP。 注意：如果将Neutron与Nova安全组结合使用，则必须将以下参数设置为False</span></span><br><span class="line">allow_overlapping_ips = True</span><br><span class="line"></span><br><span class="line">core_plugin = ml2</span><br><span class="line">service_plugins = qos,router</span><br><span class="line">dhcp_agents_per_network = 3</span><br><span class="line">l3_ha = true</span><br><span class="line">max_l3_agents_per_router = 3</span><br><span class="line">transport_url = rabbit://openstack:PASS@172.19.132.2:5672</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 系统范围的标志，用于确定租户可以创建的路由器的类型。</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 只有管理员可以覆盖</span></span><br><span class="line">router_distributed = True</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> Domain to use <span class="keyword">for</span> building the hostnames</span></span><br><span class="line">dns_domain =</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> Seconds to <span class="built_in">wait</span> <span class="keyword">for</span> a response from a call</span></span><br><span class="line">rpc_response_timeout = 300</span><br><span class="line"></span><br><span class="line">[nova]</span><br><span class="line">auth_url = http://172.19.132.40:35357</span><br><span class="line">auth_type = password</span><br><span class="line">project_domain_id = default</span><br><span class="line">user_domain_id = default</span><br><span class="line">region_name = RegionOne</span><br><span class="line">project_name = service</span><br><span class="line">username = nova</span><br><span class="line">password = kH4EhHDUFV5P7UBVnZskUzRArcoSSa4vF8PYd4zP</span><br><span class="line">endpoint_type = internal</span><br><span class="line"></span><br><span class="line">[oslo_middleware]</span><br><span class="line">enable_proxy_headers_parsing = True</span><br><span class="line"></span><br><span class="line">[oslo_concurrency]</span><br><span class="line">lock_path = /var/lib/neutron/tmp</span><br><span class="line"></span><br><span class="line">[agent]</span><br><span class="line"><span class="meta">#</span><span class="bash"> Root helper application. 使用 <span class="string">&#x27;sudo neutron-rootwrap /etc/neutron/rootwrap.conf&#x27;</span> 来使用实际的根过滤器工具. 更改为sudo<span class="string">&#x27;以跳过过滤，而直接运行命令</span></span></span><br><span class="line">root_helper = sudo neutron-rootwrap /etc/neutron/rootwrap.conf</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 节点向服务器报告状态的秒数； 应该小于agent_down_time，最好是小于或等于agent_down_time(无需设置，默认75s)的一半</span></span><br><span class="line">report_interval = 60</span><br><span class="line"></span><br><span class="line">[database]</span><br><span class="line">connection = mysql+pymysql://neutron:Pass@172.19.132.40:3306/neutron</span><br><span class="line">max_retries = -1</span><br><span class="line">max_pool_size = 10</span><br><span class="line">max_overflow = 20</span><br><span class="line">idle_timeout = 60</span><br><span class="line"></span><br><span class="line">[keystone_authtoken]</span><br><span class="line">auth_uri = http://172.19.132.40:5000</span><br><span class="line">auth_url = http://172.19.132.40:35357</span><br><span class="line">auth_type = password</span><br><span class="line">project_domain_id = default</span><br><span class="line">user_domain_id = default</span><br><span class="line">project_name = service</span><br><span class="line">username = neutron</span><br><span class="line">password = YFONWGgttKAsLSWo1GffIrTZtDVeF483wOsBVKox</span><br><span class="line">memcache_security_strategy = ENCRYPT</span><br><span class="line">memcache_secret_key = 4FlGmUgmcUrzB1KrJnye7V86iAtQq1quvp7jgJqN</span><br><span class="line">memcached_servers = 172.19.132.2:11211,172.19.132.3:11211,172.19.132.4:11211</span><br><span class="line">memcache_pool_dead_retry = 3600</span><br><span class="line">memcache_pool_socket_timeout = 1</span><br><span class="line"></span><br><span class="line">[oslo_messaging_notifications]</span><br><span class="line">driver = messagingv2</span><br><span class="line">topics = notifications</span><br><span class="line"></span><br><span class="line">[cache]</span><br><span class="line">expiration_time = 10800</span><br><span class="line">memcache_dead_retry = 3600</span><br><span class="line">memcache_socket_timeout = 1</span><br><span class="line">memcache_pool_maxsize = 100</span><br><span class="line"></span><br><span class="line">[memcache]</span><br><span class="line">dead_retry = 3600</span><br><span class="line">socket_timeout = 1</span><br></pre></td></tr></table></figure>
<h2 id="5-2、ml2-conf-ini"><a href="#5-2、ml2-conf-ini" class="headerlink" title="5.2、ml2_conf.ini"></a>5.2、ml2_conf.ini</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line">[ml2]</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 要从neutron.ml2.type_drivers namespace中加载的网络类型驱动程序的endpoint列表</span></span><br><span class="line">type_drivers = flat,vlan,vxlan,local</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 分配给租户网络的network_types的有序列表</span></span><br><span class="line">tenant_network_types = vxlan,flat,vlan</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 要从neutron.ml2.mechanism_drivers namespace中加载的网络类型驱动程序的endpoint列表</span></span><br><span class="line">mechanism_drivers = openvswitch,l2population</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 要从neutron.ml2.extension_drivers namespace中加载的网络类型驱动程序的endpoint列表</span></span><br><span class="line">extension_drivers = port_security,qos</span><br><span class="line"></span><br><span class="line">[ml2_type_vlan]</span><br><span class="line"><span class="meta">#</span><span class="bash"> List of &lt;physical_network&gt;:&lt;vlan_min&gt;:&lt;vlan_max&gt; or &lt;physical_network&gt;</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 指定可用于VLAN provider和租户网络的物理网络名称，以及每个可分配给租户网络的VLAN标签的范围</span></span><br><span class="line">network_vlan_ranges = physnet1:2:4094</span><br><span class="line"></span><br><span class="line">[ml2_type_flat]</span><br><span class="line"><span class="meta">#</span><span class="bash"> 可以用来创建flat网络的physical_network名称列表。 使用默认的“*”允许带有任意物理网络名称的平面网络。 使用空列表禁用flat网络</span></span><br><span class="line">flat_networks = physnet1</span><br><span class="line"></span><br><span class="line">[ml2_type_vxlan]</span><br><span class="line"><span class="meta">#</span><span class="bash"> &lt;vni_min&gt;：&lt;vni_max&gt;元组的逗号分隔列表，枚举可用于租户网络分配的Geneve VNI ID的范围</span></span><br><span class="line">vni_ranges = 1:1000</span><br><span class="line"><span class="meta">#</span><span class="bash"> VXLAN的组播组。 配置后，将启用将所有广播流量发送到此多播组的功能。 取消配置后，将禁用多播VXLAN模式</span></span><br><span class="line">vxlan_group = 239.1.1.1</span><br><span class="line"></span><br><span class="line">[securitygroup]</span><br><span class="line"><span class="meta">#</span><span class="bash"> L2 agent中用于安全组防火墙的驱动程序</span></span><br><span class="line">firewall_driver = openvswitch</span><br><span class="line"></span><br><span class="line">[agent]</span><br><span class="line"><span class="meta">#</span><span class="bash"> agent支持的网络类型（gre和/或vxlan）</span></span><br><span class="line">tunnel_types = vxlan</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 使用ML2 l2population机制驱动程序来学习远程MAC和IP 并提升隧道可伸缩性</span></span><br><span class="line">l2_population = true</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 启用本地ARP响应器（如果支持）。 需要OVS 2.1和ML2 l2population驱动程序。 允许交换机（在支持overlay时）本地响应ARP请求，而无需在overlay中执行昂贵的ARP广播</span></span><br><span class="line">arp_responder = true</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 使l2 agent在DVR模式下运行</span></span><br><span class="line">enable_distributed_routing = True</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 要使用的扩展列表</span></span><br><span class="line">extensions = qos</span><br><span class="line"></span><br><span class="line">[ovs]</span><br><span class="line"><span class="meta">#</span><span class="bash"> 逗号分隔的&lt;physical_network&gt;：&lt;bridge&gt;元组列表，将physical network名称映射到agent的特定于节点的Open vSwitch网桥名称，以用于flat和VLAN网络。</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 网桥名称的长度不得超过11。</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 每个网桥必须存在，并且应将一个 physical network 接口配置为端口。</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 服务器上配置的所有physical network都应具有到每个agent上适当bridge的映射。</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 注意：如果您从此映射中删除网桥，请确保将其与集成网桥断开连接，因为该agent将不再对其进行管理。</span> </span><br><span class="line">bridge_mappings = physnet1:br-ex</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> OVSDB后端的连接字符串。 将由ovsdb-client监视时使用，并在启用本机ovsdb_interface时用于所有ovsdb命令</span></span><br><span class="line">ovsdb_connection = tcp:127.0.0.1:6640</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 本地overlay（tunnel）网络端点的IP地址。 使用驻留在主机网络接口之一上的IPv4或IPv6地址。 此值的IP版本必须与neutron服务器节点上ML2 plug-in配置文件中的“overlay_ip_version”选项的值匹配</span></span><br><span class="line">local_ip = 172.19.132.2</span><br></pre></td></tr></table></figure>
<h2 id="5-3、l3-agent-ini"><a href="#5-3、l3-agent-ini" class="headerlink" title="5.3、l3_agent.ini"></a>5.3、l3_agent.ini</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">[DEFAULT]</span><br><span class="line"><span class="meta">#</span><span class="bash"> 代理的工作模式。</span> </span><br><span class="line"><span class="meta">#</span><span class="bash"> 允许的模式为：<span class="string">&#x27;legacy&#x27;</span>-保留了将L3代理部署在集中式网络节点上以提供L3服务（如DNAT和SNAT）的现有行为。如果您不想采用DVR，请使用此模式。</span> </span><br><span class="line"><span class="meta">#</span><span class="bash"> <span class="string">&#x27;dvr&#x27;</span>-此模式启用DVR功能，并且必须用于在计算主机上运行的L3代理。 <span class="string">&#x27;dvr_snat&#x27;</span>-结合DVR启用集中式SNAT支持。对于在集中式节点（或在单主机部署，例如devstack）中运行的L3代理，必须使用此模式。</span> </span><br><span class="line"><span class="meta">#</span><span class="bash"> <span class="string">&#x27;dvr_no_external&#x27;</span>-此模式仅启用在计算主机上运行的L3代理的East/West DVR路由功能，North/South功能（如DNAT和SNAT）将由以“ dvr_snat”模式运行的集中式网络节点提供。当计算主机上没有外部网络连接时，应使用此模式。</span></span><br><span class="line">agent_mode = dvr_snat</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> VRRP健康检查的时间间隔，以秒为单位。 值&gt; 0启用VRRP健康检查。 将其设置为0将禁用VRRP健康检查。 推荐值为5。</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 这将导致将ping发送到网关IP地址-要求在网关上启用ICMP_ECHO_REQUEST。 如果网关发生故障，则所有路由器都将被报告为主路由器，并且将以循环方式重复进行主选举，直到其中一台路由器恢复网关连接为止</span></span><br><span class="line">ha_vrrp_health_check_interval = 5</span><br><span class="line"></span><br><span class="line">[ovs]</span><br><span class="line"><span class="meta">#</span><span class="bash"> 与OVSDB进行交互的interface</span></span><br><span class="line">ovsdb_interface = native</span><br><span class="line">ovsdb_connection = tcp:127.0.0.1:6640</span><br></pre></td></tr></table></figure>
<h2 id="5-4、dhcp-agent-ini"><a href="#5-4、dhcp-agent-ini" class="headerlink" title="5.4、dhcp_agent.ini"></a>5.4、dhcp_agent.ini</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">[DEFAULT]</span><br><span class="line"><span class="meta">#</span><span class="bash"> 使用此文件覆盖默认的dnsmasq设置</span></span><br><span class="line">dnsmasq_config_file = /etc/neutron/dnsmasq.conf</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 允许服务来自专用元数据访问网络的元数据请求，该专用元数据访问网络的CIDR为169.254.169.254/16（或更大的前缀），并连接到Neutron路由器，VM从该路由器发送元数据：1个request。 在这种情况下，DHCP选项121将不会被注入到VM中，因为它们将能够通过路由器到达169.254.169.254。 此选项要求enable_isolated_metadata = True</span></span><br><span class="line">enable_isolated_metadata = true</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 在某些情况下，不存在Neutron路由器来提供元数据IP，但可以使用DHCP服务器来提供此信息。 设置此值将强制DHCP服务器将特定的主机路由附加到DHCP请求。 如果设置此选项，则将为所有网络激活元数据服务。</span></span><br><span class="line">force_metadata = true</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 将用作转发的DNS服务器的逗号分隔列表</span></span><br><span class="line">dnsmasq_dns_servers = 8.8.8.8,8.8.4.4</span><br><span class="line"></span><br><span class="line">[ovs]</span><br><span class="line">ovsdb_interface = native</span><br><span class="line">ovsdb_connection = tcp:127.0.0.1:6640</span><br></pre></td></tr></table></figure>
<h2 id="5-5、metadata-agent-ini"><a href="#5-5、metadata-agent-ini" class="headerlink" title="5.5、metadata_agent.ini"></a>5.5、metadata_agent.ini</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">[DEFAULT]</span><br><span class="line"><span class="meta">#</span><span class="bash"> Nova元数据服务器的IP地址或DNS名称</span></span><br><span class="line">nova_metadata_host = 172.19.132.40</span><br><span class="line">nova_metadata_port = 8775</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 在代理元数据请求时，Neutron用共享secret对Instance-ID标头进行签名，以防止欺骗。 您可以为secret选择任何字符串，但是它必须在此处以及Nova Metadata Server使用的配置中匹配。 注意：Nova使用相同的配置密钥，但在[neutron]部分中。</span> </span><br><span class="line">metadata_proxy_shared_secret = AlBIz8otjoshFQQ51oA2xeOLKMIbbYi6NqO7qZdu</span><br></pre></td></tr></table></figure>
<h1 id="6、heat"><a href="#6、heat" class="headerlink" title="6、heat"></a>6、heat</h1><p><a target="_blank" rel="noopener" href="https://docs.openstack.org/heat/ussuri/configuration/">heat config</a></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br></pre></td><td class="code"><pre><span class="line">DEFAULT]</span><br><span class="line">debug = False</span><br><span class="line">log_dir = /var/log/kolla/heat</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 已弃用：Heat CloudWatch服务器的URL</span></span><br><span class="line">heat_watch_server_url = http://172.19.132.40:8000</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> Heat元数据服务器的URL。 注意：仅当您要求实例使用与keystone catalog中不同的endpoint时，才需要设置此设置</span></span><br><span class="line">heat_metadata_server_url = http://172.19.132.40:8000</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> URL of the Heat waitcondition server</span></span><br><span class="line">heat_waitcondition_server_url = http://172.19.132.40:8000/v1/waitcondition</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> Keystone role <span class="keyword">for</span> heat template-defined users</span></span><br><span class="line">heat_stack_user_role = heat_stack_user</span><br><span class="line">stack_domain_admin = heat_domain_admin</span><br><span class="line">stack_domain_admin_password = 2pkKYmWsA4jsfUL8xD9HHww98AiHnWfjEJauW3x9</span><br><span class="line">stack_user_domain_name = heat_user_domain</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 已启用: Select deferred auth method, stored password or trusts</span></span><br><span class="line">deferred_auth_method = trusts</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> trustor roles 的子集委派给 heat。如果未设置，则在创建stack时将委派用户的所有角色</span></span><br><span class="line">trusts_delegated_roles =</span><br><span class="line"></span><br><span class="line">transport_url = rabbit://openstack:Pass@172.19.132.2:5672</span><br><span class="line"></span><br><span class="line">[heat_api]</span><br><span class="line">bind_host = 172.19.132.2</span><br><span class="line">bind_port = 8004</span><br><span class="line">workers = 5</span><br><span class="line"></span><br><span class="line">[database]</span><br><span class="line">connection = mysql+pymysql://heat:Pass@172.19.132.40:3306/heat</span><br><span class="line"><span class="meta">#</span><span class="bash"> 启动期间数据库连接重试的最大次数</span></span><br><span class="line">max_retries = -1</span><br><span class="line">max_pool_size = 10</span><br><span class="line">max_overflow = 20</span><br><span class="line">idle_timeout = 60</span><br><span class="line"></span><br><span class="line">[keystone_authtoken]</span><br><span class="line">auth_uri = http://172.19.132.40:5000</span><br><span class="line">auth_url = http://172.19.132.40:35357</span><br><span class="line">auth_type = password</span><br><span class="line">project_domain_id = default</span><br><span class="line">user_domain_id = default</span><br><span class="line">project_name = service</span><br><span class="line">username = heat</span><br><span class="line">password = RMHLYOHpgQoygpwa3SZnjdEUgThnlWyTsmttwDrv</span><br><span class="line">memcache_security_strategy = ENCRYPT</span><br><span class="line">memcache_secret_key = 4FlGmUgmcUrzB1KrJnye7V86iAtQq1quvp7jgJqN</span><br><span class="line">memcached_servers = 172.19.132.2:11211,172.19.132.3:11211,172.19.132.4:11211</span><br><span class="line">memcache_pool_dead_retry = 3600</span><br><span class="line">memcache_pool_socket_timeout = 1</span><br><span class="line"></span><br><span class="line">[cache]</span><br><span class="line">backend = oslo_cache.memcache_pool</span><br><span class="line">enabled = True</span><br><span class="line">memcache_servers = 172.19.132.2:11211,172.19.132.3:11211,172.19.132.4:11211</span><br><span class="line">expiration_time = 10800</span><br><span class="line">memcache_dead_retry = 3600</span><br><span class="line">memcache_socket_timeout = 1</span><br><span class="line">memcache_pool_maxsize = 100</span><br><span class="line"></span><br><span class="line">[trustee]</span><br><span class="line">auth_uri = http://172.19.132.40:5000</span><br><span class="line">auth_url = http://172.19.132.40:35357</span><br><span class="line">auth_type = password</span><br><span class="line">user_domain_id = default</span><br><span class="line">username = heat</span><br><span class="line">password = RMHLYOHpgQoygpwa3SZnjdEUgThnlWyTsmttwDrv</span><br><span class="line"></span><br><span class="line">[ec2authtoken]</span><br><span class="line">auth_uri = http://172.19.132.40:5000/v3</span><br><span class="line"></span><br><span class="line">[clients_keystone]</span><br><span class="line">auth_uri = http://172.19.132.40:5000</span><br><span class="line"></span><br><span class="line">[oslo_messaging_notifications]</span><br><span class="line">driver = messagingv2</span><br><span class="line">topics = notifications</span><br><span class="line"></span><br><span class="line">[clients]</span><br><span class="line">endpoint_type = internalURL</span><br><span class="line"></span><br><span class="line">[clients_heat]</span><br><span class="line">endpoint_type = publicURL</span><br><span class="line"></span><br><span class="line">[oslo_middleware]</span><br><span class="line">enable_proxy_headers_parsing = True</span><br><span class="line"></span><br><span class="line">[memcache]</span><br><span class="line">dead_retry = 3600</span><br><span class="line">socket_timeout = 1</span><br></pre></td></tr></table></figure>
<h1 id="7、ironic"><a href="#7、ironic" class="headerlink" title="7、ironic"></a>7、ironic</h1><p><a target="_blank" rel="noopener" href="https://docs.openstack.org/ironic/pike/configuration/sample-config.html">ironic config</a></p>
<h2 id="7-1、ironic-conf"><a href="#7-1、ironic-conf" class="headerlink" title="7.1、ironic.conf"></a>7.1、ironic.conf</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br></pre></td><td class="code"><pre><span class="line">[DEFAULT]</span><br><span class="line">debug = False</span><br><span class="line">log_dir = /var/log/kolla/ironic</span><br><span class="line">transport_url = rabbit://openstack:Pass@10.40.175.11:5672</span><br><span class="line">my_ip = 10.40.175.11</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 指定服务初始化期间要加载的驱动程序列表。 缺少驱动程序或无法初始化驱动程序将阻止启动 conductor 服务 默认选项是推荐的一组面向生产的驱动程序。 可以通过枚举“ironic.drivers”入口点找到系统上存在的驱动程序的完整列表。 可以在 在线开发人员文档中找到一个示例</span></span><br><span class="line">enabled_drivers =</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 指定服务初始化期间要加载的 hardware types 列表。 缺少硬件类型或无法初始化的硬件类型将阻止启动conductor服务。 此选项默认为建议的一组面向生产的硬件类型。 可以通过枚举“ironic.hardware.types”入口点找到系统上存在的硬件类型的完整列表。</span></span><br><span class="line">enabled_hardware_types = ipmi</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 指定服务初始化期间要加载的网络接口列表。 缺少网络接口或未能初始化的网络接口将阻止启动ironic-conductor服务。 必须在此处至少启用一个 被每种已启用的硬件类型支持的网络接口，否则ironic-conductor服务将无法启动。 不能为空列表。 默认值为推荐的面向生产的网络接口集。 可以通过枚举“ironic.hardware.interfaces.network”入口点来找到系统上存在的网络接口的完整列表。 设置该值时，请确保每种启用的硬件类型在每个ironic-conductor服务上都具有相同的一组启用的网络接口。</span></span><br><span class="line">enabled_network_interfaces = noop,flat,neutron</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 默认网络接口将用于未设置network_interface字段的节点。</span> </span><br><span class="line"><span class="meta">#</span><span class="bash"> 可以通过枚举“ ironic.hardware.interfaces.network”入口点来找到系统上存在的网络接口的完整列表</span></span><br><span class="line">default_network_interface = neutron</span><br><span class="line"></span><br><span class="line">enabled_boot_interfaces = pxe</span><br><span class="line">enabled_deploy_interfaces = iscsi</span><br><span class="line">enabled_management_interfaces = ipmitool</span><br><span class="line">enabled_power_interfaces = ipmitool</span><br><span class="line">enabled_inspect_interfaces = inspector,no-inspect</span><br><span class="line">enabled_console_interfaces = ipmitool-socat,no-console</span><br><span class="line">enabled_raid_interfaces = agent,no-raid</span><br><span class="line">enabled_bios_interfaces = no-bios,fake,ilo</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 端口组的默认模式。允许的值可以在关于bonding的linux内核文档中找到</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> https://www.kernel.org/doc/Documentation/networking/bonding.txt</span></span><br><span class="line">default_portgroup_mode = 802.3ad</span><br><span class="line"></span><br><span class="line">[oslo_messaging_notifications]</span><br><span class="line">transport_url = rabbit://openstack:Pass@10.40.175.11:5672</span><br><span class="line">driver = noop</span><br><span class="line"></span><br><span class="line">[api]</span><br><span class="line"><span class="meta">#</span><span class="bash"> The IP address on <span class="built_in">which</span> ironic-api listens</span></span><br><span class="line">host_ip = 10.40.175.11</span><br><span class="line">port = 6385</span><br><span class="line">api_workers = 5</span><br><span class="line"></span><br><span class="line">[database]</span><br><span class="line">connection = mysql+pymysql://ironic:Pass@10.40.175.250:3306/ironic</span><br><span class="line">max_retries = -1</span><br><span class="line"></span><br><span class="line">[keystone_authtoken]</span><br><span class="line">www_authenticate_uri = http://10.40.175.250:5000</span><br><span class="line">auth_url = http://10.40.175.250:35357</span><br><span class="line">auth_type = password</span><br><span class="line">project_domain_id = default</span><br><span class="line">user_domain_id = default</span><br><span class="line">project_name = service</span><br><span class="line">username = ironic</span><br><span class="line">password = jwC6rxS9BQvBKnU2oq7JrhUTOO2lHsW7Wvg8dhsT</span><br><span class="line">region_name = RegionOne</span><br><span class="line">valid_interfaces = internal</span><br><span class="line">memcache_security_strategy = ENCRYPT</span><br><span class="line">memcache_secret_key = uSL8Q0cquHcZZpyzqT2njlAl8Mve5fnzjxeUF6QP</span><br><span class="line">memcached_servers = 10.40.175.11:11211,10.40.175.12:11211,10.40.175.13:11211</span><br><span class="line">memcache_pool_dead_retry = 3600</span><br><span class="line">memcache_pool_socket_timeout = 1</span><br><span class="line"></span><br><span class="line">[cinder]</span><br><span class="line"><span class="meta">#</span><span class="bash">ironic 访问cinder的配资</span></span><br><span class="line">auth_url = http://10.40.175.250:35357</span><br><span class="line">auth_type = password</span><br><span class="line">project_domain_id = default</span><br><span class="line">user_domain_id = default</span><br><span class="line">project_name = service</span><br><span class="line">username = ironic</span><br><span class="line">password = jwC6rxS9BQvBKnU2oq7JrhUTOO2lHsW7Wvg8dhsT</span><br><span class="line">region_name = RegionOne</span><br><span class="line">valid_interfaces = internal</span><br><span class="line"></span><br><span class="line">[glance]</span><br><span class="line">auth_url = http://10.40.175.250:35357</span><br><span class="line">auth_type = password</span><br><span class="line">project_domain_id = default</span><br><span class="line">user_domain_id = default</span><br><span class="line">project_name = service</span><br><span class="line">username = ironic</span><br><span class="line">password = jwC6rxS9BQvBKnU2oq7JrhUTOO2lHsW7Wvg8dhsT</span><br><span class="line">region_name = RegionOne</span><br><span class="line">valid_interfaces = internal</span><br><span class="line"></span><br><span class="line">[neutron]</span><br><span class="line">auth_url = http://10.40.175.250:35357</span><br><span class="line">auth_type = password</span><br><span class="line">project_domain_id = default</span><br><span class="line">user_domain_id = default</span><br><span class="line">project_name = service</span><br><span class="line">username = ironic</span><br><span class="line">password = jwC6rxS9BQvBKnU2oq7JrhUTOO2lHsW7Wvg8dhsT</span><br><span class="line">region_name = RegionOne</span><br><span class="line">valid_interfaces = internal</span><br><span class="line">cleaning_network = vlan177</span><br><span class="line">provisioning_network = vlan177</span><br><span class="line"></span><br><span class="line">[nova]</span><br><span class="line">auth_url = http://10.40.175.250:35357</span><br><span class="line">auth_type = password</span><br><span class="line">project_domain_id = default</span><br><span class="line">user_domain_id = default</span><br><span class="line">project_name = service</span><br><span class="line">username = ironic</span><br><span class="line">password = jwC6rxS9BQvBKnU2oq7JrhUTOO2lHsW7Wvg8dhsT</span><br><span class="line">region_name = RegionOne</span><br><span class="line">valid_interfaces = internal</span><br><span class="line"></span><br><span class="line">[inspector]</span><br><span class="line"><span class="meta">#</span><span class="bash"> Authentication URL (string value)</span></span><br><span class="line">auth_url = http://10.40.175.250:35357</span><br><span class="line">auth_type = password</span><br><span class="line">project_domain_id = default</span><br><span class="line">user_domain_id = default</span><br><span class="line">project_name = service</span><br><span class="line">username = ironic</span><br><span class="line">password = jwC6rxS9BQvBKnU2oq7JrhUTOO2lHsW7Wvg8dhsT</span><br><span class="line">region_name = RegionOne</span><br><span class="line">valid_interfaces = internal</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 是否启用使用ironic-inspector进行检查。 此选项不影响new-style dynamic drivers和fake_inspector driver</span></span><br><span class="line">enabled = true</span><br><span class="line"></span><br><span class="line">[service_catalog]</span><br><span class="line">auth_url = http://10.40.175.250:35357</span><br><span class="line">auth_type = password</span><br><span class="line">project_domain_id = default</span><br><span class="line">user_domain_id = default</span><br><span class="line">project_name = service</span><br><span class="line">username = ironic</span><br><span class="line">password = jwC6rxS9BQvBKnU2oq7JrhUTOO2lHsW7Wvg8dhsT</span><br><span class="line">region_name = RegionOne</span><br><span class="line">valid_interfaces = internal</span><br><span class="line"></span><br><span class="line">[agent]</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 日志存放的目录。当将deploy_logs_storage_backend配置为“<span class="built_in">local</span>”时使用</span></span><br><span class="line">deploy_logs_local_path = /var/log/kolla/ironic</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 日志将要存储的后端</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> Allowed values: <span class="built_in">local</span>, swift</span></span><br><span class="line">deploy_logs_storage_backend = local</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> Whether Ironic should collect the deployment logs on</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> deployment failure (on_failure), always or never</span></span><br><span class="line">deploy_logs_collect = always</span><br><span class="line"></span><br><span class="line">[pxe]</span><br><span class="line"><span class="meta">#</span><span class="bash"> 裸机PXE引导时的附加参数</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> coreos.autologin:Enable CoreOS Container Linux autologin</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> rd.auto=1，启用特殊设备（例如cryptoLUKS，dmraid，mdraid或lvm）的自动组装。</span></span><br><span class="line">pxe_append_params = coreos.autologin rd.auto=1 nofb nomodeset vga=normal  console=ttyS0,115200n8</span><br><span class="line"></span><br><span class="line">[oslo_middleware]</span><br><span class="line">enable_proxy_headers_parsing = True</span><br><span class="line"></span><br><span class="line">[cache]</span><br><span class="line">memcache_dead_retry = 3600</span><br><span class="line">memcache_socket_timeout = 1</span><br><span class="line"></span><br><span class="line">[memcache]</span><br><span class="line">dead_retry = 3600</span><br><span class="line">socket_timeout = 1</span><br></pre></td></tr></table></figure>
<h2 id="7-2、dnsmasq-conf"><a href="#7-2、dnsmasq-conf" class="headerlink" title="7.2、dnsmasq.conf"></a>7.2、dnsmasq.conf</h2><p><a target="_blank" rel="noopener" href="https://github.com/imp/dnsmasq/blob/master/dnsmasq.conf.example">dnsmasq conf example</a></p>
<p><a target="_blank" rel="noopener" href="https://wiki.syslinux.org/wiki/index.php?title=PXELINUX#special">pxelinux</a></p>
<p><a target="_blank" rel="noopener" href="http://www.thekelleys.org.uk/dnsmasq/docs/dnsmasq-man.html">dnsmasq-man</a></p>
<p><a target="_blank" rel="noopener" href="https://tools.ietf.org/html/rfc5071">RFC5071</a></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> NOTE(yoctozepto): ironic-dnsmasq is used to deliver DHCP(v6) service</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> DNS service is disabled:</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 侦听此特定端口而不是标准DNS端口（53）。将此设置为零将完全禁用DNS功能，仅保留DHCP and/or TFTP</span></span><br><span class="line">port=0</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 如果希望dnsmasq仅在指定的接口（和loopback）上侦听DHCP和DNS请求，请在此处提供接口的名称（例如eth0）。 对多个接口重复该行</span></span><br><span class="line">interface=bond4.175</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 在支持它的系统上，即使仅在某些接口上侦听，dnsmasq也会绑定通配符地址。 然后，它丢弃不应回复的请求。 这样做的优点是即使接口来回更改地址也可以工作。 如果要让dnsmasq仅真正绑定它正在侦听的接口，请取消注释该选项。当你想在同一台计算机上运行另一个nameserver时。</span></span><br><span class="line">bind-interfaces</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 如果您拥有多个网络，则需要对要在其上提供DHCP的每个网络重复此操作</span></span><br><span class="line">dhcp-range=10.40.175.2,10.40.175.10</span><br><span class="line"><span class="meta">#</span><span class="bash"> 从最低的可用地址开始依次分配IP地址</span></span><br><span class="line">dhcp-sequential-ip</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 覆盖dnsmasq提供的默认路由，假定路由器与运行dnsmasq的计算机是同一台计算机。</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 3：覆盖默认路由， 10.40.175.1：默认路由IP</span></span><br><span class="line">dhcp-option=3,10.40.175.1</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 设置tftp-server 的地址为 10.40.175.11</span></span><br><span class="line">dhcp-option=option:tftp-server,10.40.175.11</span><br><span class="line">dhcp-option=option:server-ip-address,10.40.175.11</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 210 表 Path prefix，配置要附加到 ConfigFile来识别文件的目录位置</span></span><br><span class="line">dhcp-option=210,/tftpboot/</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 设置bootfile-name</span></span><br><span class="line">dhcp-option=option:bootfile-name,pxelinux.0</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 路径必须是目录，而不是单个文件。将自动读取目录中已更改或新的文件，而无需发送SIGHUP。如果文件在被dnsmasq读取后被删除或更改，则包含的主机记录将一直保留，直到dnsmasq收到SIGHUP或重新启动为止；即主机记录仅动态添加。</span></span><br><span class="line">dhcp-hostsdir=/etc/dnsmasq/dhcp-hostsdir</span><br></pre></td></tr></table></figure>
<h2 id="7-3、inspector-conf"><a href="#7-3、inspector-conf" class="headerlink" title="7.3、inspector.conf"></a>7.3、inspector.conf</h2><p><a target="_blank" rel="noopener" href="https://docs.openstack.org/ironic-inspector/latest/configuration/index.html#sample-files">ironic-inspector conf</a></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line">[DEFAULT]</span><br><span class="line">debug = True</span><br><span class="line">log_dir = /var/log/kolla/ironic-inspector</span><br><span class="line">listen_address = 10.40.175.11</span><br><span class="line">listen_port = 5050</span><br><span class="line">transport_url = rabbit://openstack:Pass@10.40.175.11:5672</span><br><span class="line"></span><br><span class="line">[oslo_messaging_notifications]</span><br><span class="line">transport_url = rabbit://openstack:Pass@10.40.175.11:5672</span><br><span class="line"></span><br><span class="line">[ironic]</span><br><span class="line">auth_url = http://10.40.175.250:35357</span><br><span class="line">auth_type = password</span><br><span class="line">project_domain_id = default</span><br><span class="line">user_domain_id = default</span><br><span class="line">project_name = service</span><br><span class="line">username = ironic-inspector</span><br><span class="line">password = ZuoOqtXQaidBx9TYQ1Qwxe90K4zdaRLhK2sDBNsB</span><br><span class="line">os_endpoint_type = internalURL</span><br><span class="line"></span><br><span class="line">[keystone_authtoken]</span><br><span class="line">www_authenticate_uri = http://10.40.175.250:5000</span><br><span class="line">auth_url = http://10.40.175.250:35357</span><br><span class="line">auth_type = password</span><br><span class="line">project_domain_id = default</span><br><span class="line">user_domain_id = default</span><br><span class="line">project_name = service</span><br><span class="line">username = ironic-inspector</span><br><span class="line">password = ZuoOqtXQaidBx9TYQ1Qwxe90K4zdaRLhK2sDBNsB</span><br><span class="line">memcache_security_strategy = ENCRYPT</span><br><span class="line">memcache_secret_key = uSL8Q0cquHcZZpyzqT2njlAl8Mve5fnzjxeUF6QP</span><br><span class="line">memcached_servers = 10.40.175.11:11211,10.40.175.12:11211,10.40.175.13:11211</span><br><span class="line">memcache_pool_dead_retry = 3600</span><br><span class="line">memcache_pool_socket_timeout = 1</span><br><span class="line"></span><br><span class="line">[database]</span><br><span class="line">connection = mysql+pymysql://ironic_inspector:Pass@10.40.175.250:3306/ironic_inspector</span><br><span class="line"></span><br><span class="line">[processing]</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 如果设置，则来自ramdisk的日志将存储在此目录中。</span></span><br><span class="line">ramdisk_logs_dir = /var/log/kolla/ironic-inspector</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 在inspect期间要添加为端口的MAC地址。 可能的值：all（所有MAC地址），active（带有IP地址的NIC的MAC地址），pxe（只有PXE启动网卡的MAC地址，如果PXE MAC不被支持，则回退到active）</span></span><br><span class="line">add_ports = all</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 当inspector从尚不知道的节点接收inspection信息时要运行的hook的名称。 默认情况下，忽略此hook</span></span><br><span class="line">node_not_found_hook = enroll</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 以逗号分隔的用于处理管道的默认hook列表。 Hook “scheduler” 使用Nova scheduler所需的最小属性来更新节点。 Hook “validate_interfaces”可确保虚拟磁盘提供了有效的NIC数据。 除非您真的知道自己在做什么，否则不要排除这两个</span></span><br><span class="line">default_processing_hooks = ramdisk_error,root_disk_selection,scheduler,validate_interfaces,capabilities,pci_devices,lldp_basic,local_link_connection</span><br><span class="line"></span><br><span class="line">[pxe_filter]</span><br><span class="line"><span class="meta">#</span><span class="bash"> PXE boot filter driver to use</span></span><br><span class="line">driver = dnsmasq</span><br><span class="line"></span><br><span class="line">[cache]</span><br><span class="line">memcache_dead_retry = 3600</span><br><span class="line">memcache_socket_timeout = 1</span><br><span class="line"></span><br><span class="line">[memcache]</span><br><span class="line">dead_retry = 3600</span><br><span class="line">socket_timeout = 1</span><br><span class="line"></span><br><span class="line">[discovery]</span><br><span class="line"><span class="meta">#</span><span class="bash"> 在Ironic中创建新节点时，enroll hook使用的Ironic驱动程序的名称</span></span><br><span class="line">enroll_node_driver = ipmi</span><br></pre></td></tr></table></figure>
<h2 id="7-4、ironic-pxe-default"><a href="#7-4、ironic-pxe-default" class="headerlink" title="7.4、ironic-pxe/default"></a>7.4、ironic-pxe/default</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">default introspect</span><br><span class="line"></span><br><span class="line">label introspect</span><br><span class="line">kernel ironic-agent.kernel</span><br><span class="line">append initrd=ironic-agent.initramfs coreos.autologin rd.auto=1 nofb nomodeset vga=normal console=ttyS0,115200n8 ipa-inspection-callback-url=http://10.40.175.250:5050/v1/continue systemd.journald.forward_to_console=yes ipa-inspection-collectors=default,logs ipa-collect-lldp=1</span><br><span class="line"></span><br><span class="line">ipappend 3</span><br></pre></td></tr></table></figure>

    </div>
     
    <div class="post-footer__meta"><p>updated at 2021-01-07</p></div> 
    <div class="post-meta__cats"></div> 
</article>


    <div class="nav">
        <div class="nav__prev">
            
                <a href="/heavyfish.github.io/2020/06/08/v2v/OVF%20Tool%20Guide/" class="nav__link">
                    <div>
                        <svg viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" width="24" height="24"><path d="M589.088 790.624L310.464 512l278.624-278.624 45.248 45.248L400.96 512l233.376 233.376z" fill="#808080"></path></svg>
                    </div>
                    <div>
                        <div class="nav__label">
                            Previous Post
                        </div>
                        <div class="nav__title">
                            no title
                        </div>
                    </div>
                </a>
            
        </div>
        <div class="nav__next">
            
        </div>
    </div>





</main>

            <footer class="footer">
    


    
     
 

 
    
        
        <p class="footer-copyright">
            Copyright © 2021 <a href="/heavyfish.github.io/">速查笔记</a>
        </p>
    
    
    <p>Powered by <a href="https://hexo.io" target="_blank">Hexo</a> | Theme - <a href="https://github.com/ChrAlpha/hexo-theme-cards" target="_blank">Cards</a></p>
</footer>

        </div>
         

 

 

 

  



 


    
 

 

 

 

 




    </body>
</html>
